# ============================================================================
# Halo V1 - Substitution-Based Configuration
# ============================================================================
# FEATURE TOGGLES AT THE TOP (Lines 43-71)
#
# Step 1: Edit substitutions to document your desired features
#   - airq_enabled: "true" or "false"
#   - ble_enabled: "true" or "false"
#   - wifi_enabled: "true" or "false"
#   - weather_enabled: "true" or "false"
#   - wireguard_enabled: "true" or "false"
#   - lvgl_pages_combo: match your feature combination
#
# Step 2: Edit packages section (Lines 90-143)
#   - Uncomment/comment package includes to match substitutions above
#   - All enabled features should have their -core/.yaml includes uncommented
#   - All disabled features should have their -stubs.yaml includes uncommented
#
# ✅ ORGANIZED & CLEAR
#   All feature selections in one place (substitutions at top)
#   Package includes kept synchronized with clear comments
# ============================================================================

substitutions:
  # Device Identity
  name: halo-v1-79e384
  friendly_name: Halo Air Quality Monitor Dev

  # Core substitutions
  device_description: ${name} - v${version}.

  # Weather configuration (if enabled below)
  weather_entity_id: "weather.hhut"
  weather_refresh_interval: "900"
  current_temp_sensor: "sensor.hhut_temperature"  # Your actual sensor
  apparent_temp_sensor: "sensor.hhut_feels_like"  # Your actual sensor

  # Network Configuration
  wifi_ssid: !secret wifihome_ssid
  wifi_password: !secret wifihome_password

  # Security
  api_encryption_key: "mLKXHYyBZgGLfMiXyWoo3Fzc/TpqbKpk0g+uYAwErMs="
  ota_password: "halo79e384"

  # ============================================================================
  # FEATURE TOGGLES - Control which features are enabled
  # ============================================================================
  # Edit ONLY these feature toggles to enable/disable features:
  # Change "enabled" ↔ "disabled" for each feature
  # Then update lvgl_pages_combo below to match your configuration
  # Everything else updates automatically!

  # Air Quality Monitoring (AirQ)
  airq_enabled: "false"          # "true" or "false"

  # BLE Presence Detection
  ble_enabled: "false"          # "true" or "false"

  # WiFi Info Display
  wifi_enabled: "false"         # "true" or "false"

  # Weather Display
  weather_enabled: "true"      # "true" or "false"

  # WireGuard VPN (requires wifi_enabled above)
  wireguard_enabled: "false"    # "true" or "false"

  # ============================================================================
  # LVGL PAGES - Must match your feature configuration above!
  # ============================================================================
  # After changing feature toggles above, update lvgl_pages_combo below:
  #
  # "clock-only":           No features enabled1
  # "airq-only":            AirQ only1
  # "wifi-only":            WiFi only1
  # "weather-only":         Weather only
  # "wireguard-only":       WiFi + WireGuard (NO AirQ)1
  # "airq-wifi":            AirQ + WiFi1
  # "airq-weather":         AirQ + Weather
  # "wifi-weather":         WiFi + Weather
  # "airq-wifi-wireguard":  AirQ + WiFi + WireGuard
  # "airq-wifi-weather":    AirQ + WiFi + Weather
  # "airq-wifi-weather-wg": AirQ + WiFi + Weather + WireGuard
  #
  lvgl_pages_combo: "weather-only"

# ============================================================================
# PACKAGE IMPORTS - Controlled by SUBSTITUTIONS Above
# ============================================================================
# To change features, edit the substitutions section at the top:
#   1. Change feature toggles (airq_feature, ble_feature, etc.)
#   2. Change lvgl_pages_combo to match your feature combination
#   3. All package includes will update automatically!
# ============================================================================

packages:
  # === CORE PACKAGES (Always Required) ===
  halo_v1_core: !include Halo-v1-Core.yaml

  # === TIME UPDATE SCRIPT ===
  # Choose based on your enabled features (see chart below)
  # time-update-clock-only.yaml:       Clock-only mode (no AirQ, no WiFi, no Weather)
  # time-update-wifi-only.yaml:        WiFi-only mode (WiFi + Clock, NO AirQ)
  # time-update-basic.yaml:            AirQ mode (with optional Weather). Must have airq_enabled=true
  # time-update-wireguard-only.yaml:   WiFi + WireGuard mode (no AirQ)
  # time-update-wireguard.yaml:        WireGuard mode (requires AirQ + WiFi + WireGuard)
  #
  # CHART:
  # Feature Combo                  | time_update package
  # ============================== | ==========================
  # Clock only                     | time-update-clock-only.yaml1
  # WiFi + Clock (your current)    | time-update-wifi-only.yaml ← USE THIS NOW1
  # AirQ + Clock                   | time-update-basic.yaml1
  # AirQ + WiFi                    | time-update-basic.yaml1
  # AirQ + Weather                 | time-update-basic.yaml
  # WiFi + Weather                 | time-update-basic.yaml (or wifi-only if no AirQ)
  # AirQ + WiFi + Weather          | time-update-basic.yaml
  # WiFi + WireGuard (no AirQ)     | time-update-wireguard-only.yaml1
  # AirQ + WiFi + WireGuard        | time-update-wireguard.yaml1
  #
  time_update_script: !include packages/time-update-clock-only.yaml
  # time_update_script: !include packages/time-update-wifi-only.yaml
  # time_update_script: !include packages/time-update-basic.yaml
  # time_update_script: !include packages/time-update-wireguard-only.yaml
  # time_update_script: !include packages/time-update-wireguard.yaml

  # === FEATURE PACKAGES ===
  # Instructions:
  #   1. Change "true"/"false" in substitutions above (lines 43-55)
  #   2. Uncomment/comment the matching includes below
  #   3. Update lvgl_pages_combo to match your configuration
  #
  # When a feature is enabled: uncomment the "*-core.yaml" or "*-display.yaml" line
  # When a feature is disabled: uncomment the "*-stubs.yaml" line

  # Air Quality Monitoring (AirQ)
  # airq: !include packages/airq-core.yaml
  airq: !include packages/airq-stubs.yaml

  # BLE Presence Detection
  # ble: !include packages/ble-core-simplified.yaml
  ble: !include packages/ble-stubs.yaml

  # WiFi Info Display
  # wifi_core: !include packages/wifi-core.yaml
  # wifi_display: !include packages/wifi-display.yaml
  wifi: !include packages/wifi-stubs.yaml

  # Weather Display
  weather_core: !include packages/weather-core.yaml
  weather_ha_actions: !include packages/weather-ha-actions.yaml
  weather_fonts: !include packages/weather-fonts-text.yaml
  # weather: !include packages/weather-stubs.yaml

  # WireGuard VPN (requires wifi_enabled = true)
  # wireguard: !include packages/wireguard.yaml
  # wireguard_display: !include packages/wireguard-display.yaml
  wireguard: !include packages/wireguard-stubs.yaml

  # Memory Statistics (Optional - for debugging)
  memory_stats: !include packages/memory-stats.yaml

  # === LVGL PAGES ===
  # Instructions:
  #   1. Update lvgl_pages_combo substitution above (line 71) to match features
  #   2. Uncomment the matching lvgl-pages-*.yaml line below
  #   3. Comment out all other lvgl_pages lines
  #
  # IMPORTANT: Must match your feature configuration above!
  # lvgl_pages: !include packages/lvgl-pages-airq-only.yaml
  # lvgl_pages: !include packages/lvgl-pages-clock-only.yaml
  # lvgl_pages: !include packages/lvgl-pages-wifi-only.yaml
  lvgl_pages: !include packages/lvgl-pages-weather-forecast-only.yaml
  # lvgl_pages: !include packages/lvgl-pages-wireguard-only.yaml
  # lvgl_pages: !include packages/lvgl-pages-airq-wifi.yaml
  # lvgl_pages: !include packages/lvgl-pages-airq-weather-forecast-only.yaml
  # lvgl_pages: !include packages/lvgl-pages-wifi-weather-forecast-only.yaml
  # lvgl_pages: !include packages/lvgl-pages-airq-wifi-weather-forecast.yaml
  # lvgl_pages: !include packages/lvgl-pages-airq-wifi-wireguard.yaml
  # lvgl_pages: !include packages/lvgl-pages-full-wireguard.yaml

# ============================================================================
# DEVICE-SPECIFIC CONFIGURATION
# ============================================================================

# WiFi credentials
wifi:
  ssid: ${wifi_ssid}
  password: ${wifi_password}
  ap:
    ssid: "Halo-79e384-Fallback"
    password: "fallback12345"

# OTA
ota:
  - platform: esphome
    password: ${ota_password}

# Default page selector (update options based on enabled features)
select:
  - platform: template
    name: "Default Page at Boot"
    id: default_page_select_boot
    optimistic: true
    options:
      - "Vertical Clock"
      # Uncomment based on enabled features:
      # - "AirQ"          # if airq_enabled
      # - "WiFi"          # if wifi_enabled
      - "Weather"       # if weather_enabled
    initial_option: "Vertical Clock"
    restore_value: true

logger:
  level: debug

# ============================================================================
# CONFIGURATION GUIDE
# ============================================================================
#
# EXAMPLE 1: Clock Only (Minimal, BLE compatible)
# ------------------------------------------------
# Features: Just the vertical clock
# RAM Usage: ~45KB
# BLE Compatible: Yes
#
# Enabled packages:
#   - airq_disabled
#   - ble_disabled
#   - wifi_disabled
#   - weather_disabled
#   - wireguard_disabled
#   - lvgl_pages: lvgl-pages-clock-only.yaml
#
# ============================================================================
#
# EXAMPLE 2: Weather Display with BLE (REVOLUTIONARY!)
# -----------------------------------------------------
# Features: Clock + Weather + BLE presence detection
# RAM Usage: ~108KB
# BLE Compatible: YES! (This was impossible before HA Actions!)
#
# Enabled packages:
#   - airq_disabled
#   - ble_enabled: !include packages/ble-core-simplified.yaml
#   - wifi_disabled
#   - weather_enabled: !include packages/weather-ha-actions.yaml
#   - wireguard_disabled
#   - lvgl_pages: !include packages/lvgl-pages-weather-forecast-only.yaml
#
# Default page options:
#   - "Vertical Clock"
#   - "Weather"
#
# ============================================================================
#
# EXAMPLE 3: Office Air Quality Monitor
# --------------------------------------
# Features: Clock + AirQ + WiFi info
# RAM Usage: ~125KB
# BLE Compatible: No (too much RAM)
#
# Enabled packages:
#   - airq_enabled: !include packages/airq-display.yaml
#   - ble_disabled
#   - wifi_enabled: !include packages/wifi-display.yaml
#   - weather_disabled
#   - wireguard_disabled
#   - lvgl_pages: !include packages/lvgl-pages-airq-wifi.yaml
#
# Default page options:
#   - "Vertical Clock"
#   - "AirQ"
#   - "WiFi"
#
# ============================================================================
#
# EXAMPLE 4: Full Features (Living Room Showcase)
# -----------------------------------------------
# Features: Everything enabled
# RAM Usage: ~140KB
# BLE Compatible: No (too much RAM)
#
# Enabled packages:
#   - airq_enabled: !include packages/airq-display.yaml
#   - ble_disabled (can't fit with all features)
#   - wifi_enabled: !include packages/wifi-display.yaml
#   - weather_enabled: !include packages/weather-ha-actions.yaml
#   - wireguard_disabled
#   - lvgl_pages: !include packages/lvgl-pages-airq-wifi-weather-forecast.yaml
#
# Default page options:
#   - "Vertical Clock"
#   - "AirQ"
#   - "WiFi"
#   - "Weather"
#
# ============================================================================
